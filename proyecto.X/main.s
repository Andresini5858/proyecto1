;*******************************************************************************
;Universidad del Valle de Guatemala
;IE2023 Programación de Microncontroladores
;Autor: Andrés Lemus 21634
;Compilador: PIC-AS (v2.40), MPLAB X IDE (v6.00)
;Proyecto: Proyecto
;Creado: 23/08/2022
;Última Modificación: 08/09/22
;*******************************************************************************
PROCESSOR 16F887
#include <xc.inc>
;*******************************************************************************
;Palabra de Configuración
;*******************************************************************************

;CONFIG1
  CONFIG  FOSC = INTRC_NOCLKOUT ; Oscillator Selection bits (INTOSCIO oscillator: I/O function on RA6/OSC2/CLKOUT pin, I/O function on RA7/OSC1/CLKIN)
  CONFIG  WDTE = OFF            ; Watchdog Timer Enable bit (WDT disabled and can be enabled by SWDTEN bit of the WDTCON register)
  CONFIG  PWRTE = OFF            ; Power-up Timer Enable bit (PWRT enabled)
  CONFIG  MCLRE = OFF            ; RE3/MCLR pin function select bit (RE3/MCLR pin function is MCLR)
  CONFIG  CP = OFF              ; Code Protection bit (Program memory code protection is disabled)
  CONFIG  CPD = OFF             ; Data Code Protection bit (Data memory code protection is disabled)
  CONFIG  BOREN = OFF           ; Brown Out Reset Selection bits (BOR enabled)
  CONFIG  IESO = OFF             ; Internal External Switchover bit (Internal/External Switchover mode is enabled)
  CONFIG  FCMEN = OFF            ; Fail-Safe Clock Monitor Enabled bit (Fail-Safe Clock Monitor is enabled)
  CONFIG  LVP = OFF             ; Low Voltage Programming Enable bit (RB3/PGM pin has PGM function, low voltage programming enabled)

;CONFIG2
  CONFIG  BOR4V = BOR21V        ; Brown-out Reset Selection bit (Brown-out Reset set to 4.0V)
  CONFIG  WRT = OFF             ; Flash Program Memory Self Write Enable bits (Write protection off)


;*******************************************************************************
;Variables
;*******************************************************************************
PSECT udata_shr 
    ban: DS 1 
    estado: DS 1
    CDIS: DS 1
    DIS: DS 1
    cantmes: DS 1
    contlseg: DS 1
    contldec: DS 1
    contlmin: DS 1
    contldecmin: DS 1
    contlhora: DS 1
    contldechora: DS 1
    contmesu: DS 1
    contmesd: DS 1
    contlmes: DS 1
    W_TEMP: DS 1
    STATUS_TEMP: DS 1

PSECT udata_bank0   
    contdiau: DS 1
    contdiad: DS 1
    feb: DS 1
    contlsega: DS 1
    contldeca: DS 1
    contlmina: DS 1
    contldecmina: DS 1
    contlhoraa: DS 1
    contldechoraa: DS 1
    contled: DS 1
    
;*******************************************************************************
;Vector Reset
;*******************************************************************************
PSECT CODE, delta=2, abs
 ORG 0x0000
    goto main
;******************************************************************************* 
; Vector ISR Interrupciones    
;******************************************************************************* 
PSECT CODE, delta=2, abs
 ORG 0x0004
PUSH:
    MOVWF W_TEMP	    ;GUARDAR EL VALOR DE W (EN UNA VARIABLE)
    SWAPF STATUS, W	    ;MOVER EL VALOR DE STATUS A W (VOLTEADOS)
    MOVWF STATUS_TEMP	    ;MOVER EL VALOR DE STATUS (AHORA EN W) A UNA VARIABLE
    
ISR:
    BANKSEL TMR1L	    ;IR AL BANCO DONDE SE ENCUENTRA EL REGISTRO TMR1L
    MOVLW 0xDC		    ;CARGAMOS VALOR DE 3036 PARA DELAY DE 1 SEGUNDO (HEXADECIMAL)
    MOVWF TMR1L		    ;AL SER DE 16 BITS PRIMERO AL NIBBLES BAJOS
    MOVLW 0X0B
    MOVWF TMR1H		    ;VALOR AL NIBBLES ALTOS
    
    BTFSC PIR1, 0	    ;REVISAR EL BIT DE INTERRUPCIONES DEL Timer1
    CALL TIMER		    ;IR A LA FUNCIóN DEL Timer1
    BTFSC INTCON, 0	    ;REVISAR BIT DE INTERRUPCION DEL PUERTO B
    CALL PRTB		    ;IR A FUNCION DEL PUERTO B
  
POP:
    SWAPF STATUS_TEMP, W    ;MOVER EL VALOR DE STATUS GUARDADO EN UNA VARIABLE A W
    MOVWF STATUS	    ;MOVER EL VALOR DE STATUS (AHORA EN W) A STATUS
    SWAPF W_TEMP, F	    ;VOLTEAR LOS NIBBLES PARA QUE AL MOVERLOS A W ESTEN EN ORDEN 
    SWAPF W_TEMP, W	    ;MOVER EL VALOR DE W GUARDADO A W
    RETFIE		    ;REGRESAR DE LA INTERRUPCIóN 
    
PRTB:
    BTFSS INTCON, 0	    ;REVISAR BIT DE INTERRUPCION DEL PUERTO B
    GOTO POP		    ;SALIR DE LA INTERRUPCION SI ES 0
    BCF INTCON, 0	    ;LIMPIAR BANDERA DE INTERRUPCION
    BTFSC estado, 0	    ;SI ES ESTADO 0 Y LA ALARMA ESTA SONANDO QUE SE APAGUE
    CALL APAGARALARMA	    ;IR A FUNCION DE APAGAR ALARMA
    BTFSC estado, 4	    ;REVISAR SI ES ESTADO 4
    GOTO $+9		    ;IR A BOTONES DE CONFIGURACION DE ALARMA
    BTFSC estado, 1	    ;REVISAR SI ES ESTADO 1 
    GOTO $+25		    ;IR A MODO LECTURA DE HORA
    BTFSC estado, 3	    ;REVISAR SI ES ESTADO 3
    GOTO $+14		    ;IR A MODO DE CONFIGURACION DE HORA	
    BTFSC estado, 0	    ;REVISAR SI ES ESTADO 0
    GOTO $+33		    ;IR A MODO LECTURA DE HORA
    BTFSC estado, 2	    ;REVISAR SI ES ESTADO 2
    GOTO $+31		    ;IR A MODO LECTURA DE FECHA
    BTFSS PORTB, 3	    ;REVISAR SI SE PRESIONO BOTON DE AUMENTO
    CALL ANTI1		    ;LLAMAR ANTIRREBOTE
    BTFSC PORTB, 3	    ;REVISAR SI SE SOLTO EL BOTON
    CALL VERI1A		    ;IR A FUNCION DE AUMENTAR ALARMA
    BTFSS PORTB, 4	    ;REVISAR SI SE PRESIONO BOTON DE DECREMENTO
    CALL ANTI2		    ;IR A ANTIRREBOTE
    BTFSC PORTB, 4	    ;REVISAR SI SE SOLTO EL BOTON;
    CALL VERI1DA	    ;IR A FUNCION DE DECREMENTO DE ALARMA
    GOTO $+18		    ;IR A FUNCION DE AUMENTO DE SEGUNDO, MINUTOS U HORAS DE ALARMA
    BTFSS PORTB, 3	    ;REVISAR SI SE PRESIONO EL BOTON
    CALL ANTI1		    ;LLAMAR ANTIRREBOTE
    BTFSC PORTB, 3	    ;REVISAR SI SE PRESIONO BOTON DE AUMENTO
    CALL VERI6		    ;LLAMAR FUNCION DE AUMENTO DE MES
    BTFSS PORTB, 4	    ;REVISAR SI SE PRESIONO EL BOTON
    CALL ANTI2		    ;LLAMAR ANTIRREBOTE
    BTFSC PORTB, 4	    ;REVISAR SI SE DEJO DE PRESIONAR EL BOTON
    CALL VERI1DF	    ;LLAMAR FUNCION DE DECREMENTO DE MES
    GOTO $+9		    ;IR A FUNCION DE AUMENTO DE MESES O DIAS
    BTFSS PORTB, 3	    ;REVISAR SI SE PRESIONO EL BOTON DE AUMENTO
    CALL ANTI1		    ;LLAMAR A ANTIRREBOTE
    BTFSC PORTB, 3	    ;REVISAR SI SE DEJO DE PRESIONAR EL BOTON
    CALL VERI1		    ;IR A FUNCION DE AUMENTO DE HORA
    BTFSS PORTB, 4	    ;REVISAR SI SE PRESIONO BOTON DE DECREMENTO
    CALL ANTI2		    ;LLAMAR ANTIRREBOTE
    BTFSC PORTB, 4	    ;REVISAR SI SE DEJO DE PRESIONAR EL BOTON
    CALL VERI1D		    ;LLAMAR A FUNCION DE DECREMENTO
    BTFSS PORTB, 5	    ;IR A FUNCION DE AUMENTO O DECREMENTO DE SEGUNDOS, MINUTOS U HORAS
    CALL ANTI4		    ;LLAMAR ANTIRREBOTE
    BTFSC PORTB, 5	    ;REVISAR SI SE PRESIONO EL BOTON
    CALL REVISION1	    ;IR FUNCION DE SELECCION DE AUMENTO DECREMENTO  
    BTFSC estado, 0	    ;REVISAR SI ES ESTADO 0
    GOTO ESTADO0_ISR	    ;IR A FUNCION DE ESTADO 0
    BTFSC estado, 1	    ;REVISAR SI ES ESTADO 1
    GOTO ESTADO1_ISR	    ;IR A FUNCION DE ESTADO 1
    BTFSC estado, 2	    ;REVISAR SI ESTADO 2
    GOTO ESTADO2_ISR	    ;IR A FUNCION DE ESTADO 2
    BTFSC estado, 3	    ;REVISAR SI ESTADO 3
    GOTO ESTADO3_ISR	    ;IR A FUNCION DE ESTADO 3
    BTFSC estado, 4	    ;REVISAR SI ES ESTADO 4
    GOTO ESTADO4_ISR	    ;IR A ESTADO 4
    
APAGARALARMA:
    BTFSS PORTB, 7	    ;REVISAR SI SE PRESIONO BOTON DE APAGAR ALARMA
    BSF PORTA, 5	    ;APAGAR ALARMA
    RETURN		    ;REGRESAR
    
ESTADO0_ISR:
    BTFSS PORTB, 6	    ;REVISAR SI SE PRESIONO BOTON DE CAMBIO DE ESTADO
    CALL ANTI3		    ;LLAMAR ANTIRREBOTE
    BTFSC PORTB, 6	    ;REVISAR SI SE DEJO DE PRESIONAR EL BOTON
    CALL ES0		    ;IR A FUNCION
    BCF INTCON, 0	    ;LIMPIAR BANDERA DE INTERRUPCION
    BSF CDIS, 0		    ;CONFIGURACION PARA EL SIGUIENTE ESTADO
    BCF CDIS, 1		    ;SETEAR QUE SE INICIE CARGANDO POR DEFECTO DEL CAMBIO DE SEGUNDO Y MES
    BCF CDIS, 2
    BCF CDIS, 3
    BCF CDIS, 4
    BCF CDIS, 5
    GOTO POP		    ;IR A POP
    
ES0:
    BTFSS ban, 2	    ;REVISAR BANDERA
    RETURN		    ;REGRESAR
    BSF estado, 1	    ;ACTIVAR ESTADO1
    BCF estado, 0	    ;LIMPIAR ESTADO0
    CLRF ban		    ;LIMPIAR BANDERA
    RETURN
    
    
ESTADO1_ISR:
    BTFSS PORTB, 6	    ;REVISAR SI SE PRESIONO BOTON DE CAMBIO DE MODO
    CALL ANTI3		    ;LLAMAR ANTIRREBOTO
    BTFSC PORTB, 6	    ;REVISAR SI SE DEJO DE PRESIONAR EL BOTON
    CALL ES1		    ;LLAMAR FUNCION DE ESTADO1
    BCF INTCON, 0	    ;LIMPIAR BANDERA DE INTERRUPCION
    BSF DIS, 0		    ;SETEAR QUE COMIENCE EN LOS SEGUNDOS
    GOTO POP		    ;REGRESAR
    
ES1:
    BTFSS ban, 2	    ;REVISAR BANDERA
    RETURN		    ;REGRESAR
    BSF estado, 2	    ;PONER ESTADO 2
    BCF estado, 1	    ;QUITAR ESTADO 1
    CLRF ban		    ;LIMPIAR BANDERA
    RETURN		    ;REGRESAR
    
ESTADO2_ISR:
    BTFSS PORTB, 6	    ;REVISAR BOTON DE CAMBIO DE MODO
    CALL ANTI3		    ;LLAMAR ANTIRREBOTE
    BTFSC PORTB, 6	    ;REVISAR SI DEJO DE PRESIONAR EL BOTON
    CALL ES2		    ;IR A FUNCION DE ESTADO SIGUIENTE
    BCF INTCON, 0	    ; RBIF = 0
    BSF CDIS, 0		    ;SETEAR CONFIGURACION SIGUIENTE ESTADO
    BCF CDIS, 1
    BCF CDIS, 2
    BCF CDIS, 3
    BCF CDIS, 4
    BCF CDIS, 5
    GOTO POP
    
ES2:
    BTFSS ban, 2	    ;REVISAR BANDERA
    RETURN		    ;REGRESAR
    BSF estado, 3	    ;PONER ESTADO 3
    BCF estado, 2	    ;QUITAR ESTADO 2
    CLRF ban		    ;LIMPIAR BANDERA
    RETURN		    ;REGRESAR
    
ESTADO3_ISR:
    BTFSS PORTB, 6	    ;REVISAR SI SE PRESIONO EL BOTON
    CALL ANTI3		    ;LLMAR AL ANTIRREBOTE
    BTFSC PORTB, 6	    ;REVISAR SI SE DEJO DE PRESIONAR EL BOTON
    CALL ES3		    ;LLAMAR FUNCION DE ESTADO SIGUIEBTE
    BCF INTCON, 0	    ; RBIF = 0
    BSF DIS, 0		    ;SETEAR CONFIGURACION SIGUIENTE ESTADO
    GOTO POP		    ;REGRESAR
    
ES3:
    BTFSS ban, 2	    ;REVISAR BANDERA
    RETURN		    ;REGRESAR
    BSF estado, 4	    ;PONER ESTADO 4
    BCF estado, 3	    ;QUITAR ESTADO 3
    CLRF ban		    ;LIMPIAR BANDERA
    RETURN
    
ESTADO4_ISR:
    BTFSS PORTB, 6	    ;REVISAR SI SE PRESIONO EL BOTON
    CALL ANTI3		    ;LLAMAR ANTIRREBOTE
    BTFSC PORTB, 6	    ;REVISAR SI SE DEJO PRESIONAR EL BOTON
    CALL ES4		    ;LLMAR FUNCION DE ESTADO SIGUIENTE
    BCF INTCON, 0	    ; RBIF = 0
    BSF DIS, 0		    ;SETEAR CONFIGURACION DE ESTADO SIGUIENTE
    GOTO POP   
    
ES4:
    BTFSS ban, 2	    ;REVISAR BANDERA
    RETURN		    ;REGRESAR
    BSF estado, 0	    ;PONER ESTADO 0 
    BCF estado, 4	    ;QUITAR ESTADO 4
    CLRF ban		    ;LIMPIAR BANDERA
    RETURN
    
REVISION1:		    
    BTFSS ban, 3	    ;REVISAR BANDETA
    RETURN		    ;REGREASAR
    BTFSC CDIS, 0	    ;VER SI ESTA SELECCIONADO CAMBIO DE SEGUNDOS/MES, MINUTOS/DIA U HORA
    GOTO CDIS0ISR
    BTFSC CDIS, 1
    GOTO CDIS1ISR
    BTFSC CDIS, 2
    GOTO CDIS2ISR
    GOTO POP		    ;REGRESAR
    
CDIS0ISR:   
    BCF CDIS, 0		    ;QUITAR CAMBIO DE SEGUNDOS/ MES
    BSF CDIS, 1		    ;PONER CAMBIOS DE MINUTOS DIA
    BCF INTCON, 0	    ;LIMPIAR BANDERA DE INTERRUPCION
    CLRF ban		    ;LIMPIAR ANTIRREBOTE
    RETURN
    
CDIS1ISR:
    BCF CDIS, 1		    ;QUITAR CAMBIOS MINUTOS/DIA
    BSF CDIS, 2		    ;PONER CAMBIO DE HORAS
    BCF INTCON, 0	    ;LIMPIAR INTERRUPCION
    BTFSC estado, 3	    ;REVISAR SI ES ESTADO 3
    CALL MES		    ;REGRESAR AL CAMBIO DE MES
    CLRF ban
    RETURN
    
MES:
    BSF CDIS, 0		    ;PONER CAMBIO MES
    BCF CDIS, 1		    ;QUITAR CAMBIO DIA
    RETURN
    
CDIS2ISR:
    BCF CDIS, 2		    ;QUITAR CAMBIO DE HORAS
    BSF CDIS, 0		    ;PONER CAMBIO DE SEGUNDOS
    BCF INTCON, 0
    CLRF ban		    ;LIMPIAR BANDERA
    RETURN
    
TIMER:
    BCF PIR1, 0		    ;REVISAR BANDERA DE INTERRUPCION TIMER1
    BANKSEL TMR1L	    ;CARGAR VALOR DE TIMER1 PARA DELAY DE 1s
    MOVLW 0xDC
    MOVWF TMR1L
    MOVLW 0X0B
    MOVWF TMR1H
    GOTO VERI1		    ;IR AL INCREMENTO DE SEGUNDOS
    
VERI1:
    BCF INTCON, 0	    ;LIMPIAR BANDERA DE INTERRUPCION DE PUERTO B
    BTFSS estado, 1	    ;REVISAR SI ESTADO 1
    GOTO $+7		    ;SI NO IR A INCREMENTAR SEGUNDOS EN MODO TIMER
    BTFSS CDIS, 0	    ;REVISAR SI SE QUIEREN INCREMENTAR SEGUNDOS
    GOTO VERI3		    ;SI NO IR A INCREMENTAR MINUTOS
    BTFSS ban, 0	    ;REVISAR BANDERA
    RETURN		    ;REGRESAR
    CLRF ban		    ;LIMPIAR BANDERA DE ANTIRREBOTE
    GOTO $+3		    ;SI ES MODO DE CONFIGURACION INCREMENAR
    BTFSS estado, 0	    ;REVISAR SI ES ESTADO 0
    RETURN		    ;REGRESAR
    INCF contlseg, F	    ;INCREMENTAR CONTADOR DE UNIDADES DE SEGUNDO
    BCF INTCON, 0	    ;LIMPIAR BANDERA DE PUERTO B
    MOVF contlseg, W	    ;MOVER EL VALOR DEL CONTADOR A W
    SUBLW 10		    ;RESTAR 10 DE W
    BTFSS STATUS, 2	    ;REVISAR SI LA RESTA ES 0
    RETURN		    ;SI LA RESTA NO ES 0, RETORNAR
    CLRF contlseg	    ;SI ES 0, REINCIAR EL CONTADOR
    GOTO VERI2		    ;IR A INCREMENTAR DECENAS DE SEGUNDO
    
VERI2:
    BCF INTCON, 0	    ;LIMPIAR BANDERA DEL PUERTO B
    INCF contldec, F	    ;INCREMENTAR CONTADOR DE DECENAS DE SEGUNDO
    MOVF contldec, W	    ;MOVER EL VALOR DEL CONTADOR A W 
    SUBLW 6		    ;RESTAR 6 DE W, YA QUE QUEREMOS QUE CUANDO LLEGUE A 60 SE REINICIE
    BTFSS STATUS, 2	    ;CHEQUEAR SI LA RESTA ES 0
    RETURN		    ;SI NO ES 0, RETORNAMOS
    CLRF contlseg	    ;SI ES 0 LIMPIAR EL CONTADOR DE UNIDADES DE SEGUNDOS
    CLRF contldec           ;SI ES 0 LIMPIAR EL CONTADOR DE DECENAS DE SEGUNDOS
    BTFSC estado, 1	    ;REVISAR SI ES ESTADO 1
    RETURN		    ;REGREASR
    GOTO VERI3		    ;IR A INCREMENTO DE UNIDADES DE MINUTO

VERI3:
    BCF INTCON, 0	    ;LIMPIAR BANDERA DEL PUERTO B   
    BTFSS estado, 1	    ;REVISAR SI ESTADO 1
    GOTO $+7		    ;SI NO IR A INCREMENTAR SEGUNDOS EN MODO TIMER
    BTFSS CDIS, 1	    ;REVISAR SI SE QUIEREN INCREMENTAR MINUTOS
    GOTO VERI5		    ;SI NO IR A INCREMENTAR HORAS
    BTFSS ban, 0	    ;REVISAR SI ES ESTADO 0
    RETURN		    ;REGRESAR
    CLRF ban		    ;LIMPIAR BANDERA DE ANTIRREBOTE
    GOTO $+3		    ;SI ES MODO DE CONFIGURACION INCREMENAR
    BTFSS estado, 0	    ;REVISAR SI ESTADO 0
    RETURN		    ;REGRESAR
    INCF contlmin, F        ;INCREMENTAR CONTADOR DE DECENAS DE SEGUNDO
    MOVF contlmin, W        ;MOVER EL VALOR DEL CONTADOR A W 
    SUBLW 10		    ;RESTAR 6 DE W, YA QUE QUEREMOS QUE CUANDO LLEGUE A 60 SE REINICIE
    BTFSS STATUS, 2	    ;CHEQUEAR SI LA RESTA ES 0
    RETURN		    ;SI NO ES 0, RETORNAMOS
    CLRF contlmin	    ;SI ES 0 LIMPIAR EL CONTADOR DE UNIDADES DE MINUTOS
    CLRF contldec           ;SI ES 0 LIMPIAR EL CONTADOR DE DECENAS DE SEGUNDOS
    CLRF contlseg	    ;SI ES 0 LIMPIAR EL CONTADOR DE UNIDADES DE SEGUNDOS
    GOTO VERI4		    ;IR A AUMENTO DE DECENAS DE SEGUNDOS

VERI4:
    INCF contldecmin, F	    ;INCREMENTAR CONTADOR DE DECENAS DE MINUTO
    MOVF contldecmin, W	    ;MOVER EL VALOR DEL CONTADOR A W 
    SUBLW 6		    ;RESTAR 6 DE W, YA QUE QUEREMOS QUE CUANDO LLEGUE A 60 SE REINICIE
    BTFSS STATUS, 2	    ;CHEQUEAR SI LA RESTA ES 0
    RETURN		    ;SI NO ES 0, RETORNAMOS
    CLRF contldecmin	    ;LIMPIAR DECENAS DE MINUTOS
    CLRF contlmin	    ;LIMPIAR UNIDADES DE MINUTOS
    CLRF contlseg	    ;SI ES 0 LIMPIAR EL CONTADOR DE UNIDADES DE SEGUNDOS
    CLRF contldec           ;SI ES 0 LIMPIAR EL CONTADOR DE DECENAS DE SEGUNDOS
    BTFSC estado, 1	    ;REVISAR SI ESTADO 1
    RETURN		    ;RETORNAR
    GOTO VERI5		    ;IR A AUMENTO DE HORAS (FUERA DE INTERRUPCIONES YA NO HABIA ESPACIO)

    
;*******************************************************************************
;Código Principal
;*******************************************************************************
PSECT CODE, delta=2, abs
 ORG 0x0150
 
tabla:			    ;TABLA DE VALORES PARA DISPLAY
    CLRF PCLATH
    BSF PCLATH, 0
    ANDLW 0x0F		    ;SE PONE UN LíMITE DE 15
    ADDWF PCL		    ;SUMA ENTRE PCL Y W
    RETLW 00111111B;0
    RETLW 00000110B;1
    RETLW 01011011B;2
    RETLW 01001111B;3
    RETLW 01100110B;4
    RETLW 01101101B;5
    RETLW 01111101B;6
    RETLW 00000111B;7
    RETLW 01111111B;8
    RETLW 01100111B;9
    RETLW 01110111B;A
    RETLW 01111100B;B
    RETLW 00111001B;C
    RETLW 01011110B;D
    RETLW 01111001B;E
    RETLW 01110001B;F
    
main:
    BANKSEL ANSEL	    ;PONER PUERTOS COMO DIGITALES
    CLRF ANSEL
    CLRF ANSELH
    
    BANKSEL TRISA
    CLRF TRISA		    ;PUERTO A COMO SALIDA
    CLRF TRISC		    ;PUERTO C COMO SALIDA
    BCF TRISD, 0	    ;PIN 0 DEL PUERTO D COMO SALIDA
    BCF TRISD, 1	    ;PIN 1 DEL PUERTO D COMO SALIDA
    BCF TRISD, 2	    ;PIN 2 DEL PUERTO D COMO SALIDA
    BCF TRISD, 3	    ;PIN 3 DEL PUERTO D COMO SALIDA
    BCF TRISD, 4	    ;PIN 4 DEL PUERTO D COMO SALIDA
    BCF TRISD, 5	    ;PIN 5 DEL PUERTO D COMO SALIDA
    CLRF TRISE		    ;PUERTO E COMO SALIDA
    
    BANKSEL TRISB
    BSF TRISB, 3	    ;PIN 3 DEL PUERTO B COMO SALIDA
    BSF TRISB, 4	    ;PIN 4 DEL PUERTO B COMO SALIDA
    BSF TRISB, 5	    ;PIN 5 DEL PUERTO B COMO SALIDA
    BSF TRISB, 6	    ;PIN 6 DEL PUERTO B COMO SALIDA
    BSF TRISB, 7	    ;PIN 7 DEL PUERTO B COMO SALIDA
    
    BANKSEL PORTA	    ;IR AL BANCO 0
    MOVLW 00100000B	    ;MOVER CONFIGURACION DE INICIO AL PUERTO (PIN6 EN UNO PARA QUE ALARMA NO SUENE)
    MOVWF PORTA		    ;MOVERLO AL PUERTO A
    CLRF PORTB		    ;LIMPIAR PUERTO B
    CLRF PORTC		    ;LIMPIAR PUERTO C
    CLRF PORTD		    ;LIMPIAR PUERTO D
    BSF PORTE, 0	    ;INICIAR PIN0 DEL PUERTO E EN UNO PARA LEDS CON DELAY DE CADA 500ms
    
    MOVLW 1		    ;INICIAR VARIABLES EN 1
    MOVWF contdiau	    ;UNIDADES DE DIA
    CLRF contdiad	    ;LIMPIAR DECENAS DE DIA
    CLRF feb		    ;LIMPIAR FEBRERO
    CLRF contlsega	    ;LIMPIAR UNIDADES DE SEGUNDOS ALARMA
    CLRF contldeca	    ;LIMPIAR DECENAS SEGUNDOS ALARMA
    CLRF contlmina	    ;LIMPIAR UNIDADES DE MINUTOS ALARMA
    CLRF contldecmina	    ;LIMPIAR DECENAS DE MINUTOS ALARMA
    CLRF contled	    ;LIMPIAR VARIABLE PARA DELAY DE LEDS
    MOVLW 1		    
    MOVWF contldechoraa
    MOVLW 2
    MOVWF contlhoraa
    
    BANKSEL WPUB	    ;DETERMINAR PINES QUE VAN A LLEVAR PULL-UPS
    BSF WPUB, 3		    ;SI PULL-UP
    BSF WPUB, 4		    ;SI PULL-UP
    BSF WPUB, 5		    ;SI PULL-UP
    BSF WPUB, 6		    ;SI PULL-UP
    BSF WPUB, 7		    ;SI PULL-UP
    
    BANKSEL IOCB	    ;DETERMINAR PINES QUE VAN A LLEVAR INTERRUPCIóN ON-CHANGE
    BSF IOCB, 3		    ;SI INTERRUPCION
    BSF IOCB, 4		    ;SI INTERRUPCION
    BSF IOCB, 5		    ;SI INTERRUPCION
    BSF IOCB, 6		    ;SI INTERRUPCIóN
    BSF IOCB, 7		    ;SI INTERRUPCION
    
    BANKSEL INTCON	    ;ACTIVAR INTERRUPCIONES
    BSF INTCON, 7	    ;ACTIVAR BIT DE INTERRUPCIONES GLOBALES
    BSF INTCON, 6	    ;ACTIVAR INTERRUPCIONES PERIFERICAS
    BSF INTCON, 3	    ;ACTIVAR BIT DE INTERRUPCIONES DEL PUERTO B
    BCF INTCON, 0	    ;LIMPIAR BANDERA DE INTERRUPCION PUERTO B
    
    BANKSEL PIE1
    BSF PIE1, 0		    ;ACTIVAR INTERRUPCIONES TIMER1
    BCF PIE1, 1		    ;DESACTIVAR INTERRUPCIONES TIEMR2
    
    BANKSEL PIR1    
    BCF PIR1, 0		    ;LIMPIAR BANDERA INTERRUPCION TIMER1
    
    BANKSEL T1CON
    BSF T1CON, 5	    ;ELEGIR PRESCALER DE 4 PARA TIMER1
    BCF T1CON, 4
    BCF T1CON, 1	    ;RELOJ INTERNO
    BSF T1CON, 0	    ;ENCENDER TIMER1
    
    BANKSEL T2CON	    
    BCF T2CON, 6	    ;POSTCALER DE 5 TIMER2
    BSF T2CON, 5
    BCF T2CON, 4
    BCF T2CON, 3
    BSF T2CON, 2	    ;ENCENDER TIMER2
    BCF T2CON, 1	    ;PRESCALER DE 1
    BCF T2CON, 0
    
    BANKSEL TMR1L	    ;CARGAR VALOR AL TIMER1 PARA DELAY DE 1s
    MOVLW 0xDC
    MOVWF TMR1L
    MOVLW 0X0B
    MOVWF TMR1H

    BANKSEL OSCCON
    BSF OSCCON, 6	    ;CONFIGURAR OSCILADOR INTERNO A 1MHz
    BCF OSCCON, 5
    BCF OSCCON, 4    
    BSF OSCCON, 0	    ;DETERMINAR QUE SE UTLIZARá OSCILADOR INTERNO
    
    BANKSEL OPTION_REG
    BCF OPTION_REG, 7	    ;LIMPIAR BIT PARA QUE SE PUEDAN USAR PULL-UPS DEL PUERTO B
    BCF OPTION_REG, 5	    ;UTILIZAR EL Timer0 CON EL OSCILADOR INTERNO 
    BCF OPTION_REG, 3	    ;UTILIZAR PRESCALER CON EL Timer0
    
    BSF OPTION_REG, 2	    ;PRESCALER DE 256
    BSF OPTION_REG, 1	    
    BSF OPTION_REG, 0
    
    MOVLW 0x01		    ;INICAR EN 1 ALGUNAS VARIABLES
    MOVWF contmesu	    ;UNIDADES DE MES
    MOVWF contlmes	    ;CONTADOR DE MES
    CLRF cantmes	    ;DETERMINAR SI ES MES DE 30 O 31 DIAS
    CLRF contlseg	    ;LIMPIAR VARIBLE DE UNIDADES DE SEGUNDOS PARA QUE INICIE EN 0
    CLRF contldec	    ;LIMPIAR VARIBLE DE CONTADOR PARA DELAY DE 1s PARA QUE INICIE EN 0
    CLRF contlmin	    ;INICIAR VARIABLES DE TIEMPO LIMPIAS
    CLRF contldecmin
    CLRF contlhora
    CLRF contldechora
    CLRF contmesd
    MOVLW 0x01		    ;INICIAR EN ESTADO 0
    MOVWF estado
    MOVWF DIS
    MOVWF CDIS
    CLRF ban
    
    BANKSEL TMR2	    ;IR AL BANCO DEL TIMER 0
    MOVLW 200		    ;MOVER VALOR PARA DELAY DE 20ms a W
    MOVWF TMR2		    ;PONER EL VALOR PARA DELAY DE 20ms EN EL Timer0
    
    BANKSEL TMR0	    ;IR AL BANCO DEL TIMER 0
    MOVLW 253		    ;MOVER VALOR PARA DELAY DE 20ms a W
    MOVWF TMR0		    ;PONER EL VALOR PARA DELAY DE 20ms EN EL Timer0

LOOP:
    BTFSC PORTE, 0	    ;REVISAR SI LOS LEDS ESTAN APAGADOS O ENCENDIDOS
    CALL LEDS		    ;LLAMAR A FUNCION DE APAGAR LEDS
    CALL LEDS2		    ;LLAMAR A FUNCION DE ENCENDER LEDS
    BTFSC estado, 0	    ;REVISAR SI ES ESTADO 0
    GOTO HORA		    ;IR A MODO LECTURA DE HORA	
    BTFSC estado, 1	    ;REVISAR SI ES ESTADO 1
    GOTO CONFIGHORA	    ;IR A MODO CONFIGURACION DE HORA
    BTFSC estado, 2	    ;REVISAR SI ES ESTADO 2 
    GOTO FECHA		    ;IR A MODO DE VER FECHA
    BTFSC estado, 3	    ;REVISAR SI ES ESTADO 2
    GOTO CONFIGFECHA	    ;IR A MODO DE CONFIGURACION DE FECHA   
    BTFSC estado, 4	    ;REVISAR SI ES ESTADO 4
    GOTO ALARMA		    ;IR A MODO ALARMA
    
    
HORA:
    BTFSC PORTA, 5	    ;REVISAR SI ESTA SONANDO ALARMA
    GOTO $+4		    ;SI NO ESTA SONANDO, MANTENER APAGADA Y ENCENDER LED DE ESTADO 0
    GOTO $+1		    ;SI ESTA SONANDO MANTENER ENCENDIDA HASTA PRESIONAR EL BOTON
    MOVLW 00000001B	    ;ALARMA ENCENDIDA
    GOTO $+2		    ;SE MUEVE AL PUERTO A
    MOVLW 00100001B	    ;ALARMA APAGADA
    MOVWF PORTA		    ;SE MUEVE AL PUERTO A
    CALL CHECK		    ;LLAMAR A CHEQUEO PARA VER SI SUENA ALARMA
    BCF TRISB, 3	    ;DESACTIVAR BOTONES EN MODO HORA
    BCF TRISB, 4
    BCF IOCB, 4
    BCF IOCB, 3
    BSF INTCON, 6	    ;ACTIVAR INTERRUPCIONES DEL TIMER1
    BTFSC DIS, 0	    ;MULTIPLEXEO DE DISPLAYS
    GOTO DIS0
    BTFSC DIS, 1
    GOTO DIS1
    BTFSC DIS, 2
    GOTO DIS2
    BTFSC DIS, 3
    GOTO DIS3
    BTFSC DIS, 4
    GOTO DIS4
    BTFSC DIS, 5
    GOTO DIS5
    
CONFIGHORA:
    MOVLW 00100010B	    ;ENCENDER LED DE ESTADO1
    MOVWF PORTA		
    BSF TRISB, 3	    ;ACTIVAR BOTONES EN MODO CONFIGURACION
    BSF TRISB, 4
    BSF IOCB, 3
    BSF IOCB, 4
    BCF INTCON, 6	    ;DESACTIVAR INTERRUPCIONES DEL TIMER1 EN MODO DONFIGURACION
    BTFSC DIS, 0	    ;MULTIPLEXEO DE DISPLAYS
    GOTO DIS0
    BTFSC DIS, 1
    GOTO DIS1
    BTFSC DIS, 2
    GOTO DIS2
    BTFSC DIS, 3
    GOTO DIS3
    BTFSC DIS, 4
    GOTO DIS4
    BTFSC DIS, 5
    GOTO DIS5
    
FECHA:
    MOVLW 00100100B	    ;ENCENDER LED DE ESTADO 2
    MOVWF PORTA
    BCF TRISB, 3	    ;DESCATIVAR BOTONES EN MODO DE VER FECHA
    BCF TRISB, 4
    BCF IOCB, 4
    BCF IOCB, 3
    BSF INTCON, 6	    ;ACTIVAR INTERRUPCIONES DEL TIMER1
    BTFSC DIS, 0	    ;MULTIPLEXEO DE DISPLAYS
    GOTO DIS0
    BTFSC DIS, 1
    GOTO DIS1
    BTFSC DIS, 2
    GOTO DIS2
    BTFSC DIS, 3
    GOTO DIS3
    BTFSC DIS, 4
    GOTO DIS4
    BTFSC DIS, 5
    GOTO DIS5
    
CONFIGFECHA:
    MOVLW 00101000B	    ;ENCENDER LED DE ESTADO 3
    MOVWF PORTA
    BSF TRISB, 3	    ;ACTIVAR BOTONES EN MODO CONFIGURACION DE FECHA
    BSF TRISB, 4
    BSF IOCB, 3
    BSF IOCB, 4
    BCF INTCON, 6	    ;DESACTIVAR INTERRUPCIONES DEL TIMER1
    BTFSC DIS, 0	    ;MULTIPLEXEO DISPLAYS
    GOTO DIS0
    BTFSC DIS, 1
    GOTO DIS1
    BTFSC DIS, 2
    GOTO DIS2
    BTFSC DIS, 3
    GOTO DIS3
    BTFSC DIS, 4
    GOTO DIS4
    BTFSC DIS, 5
    GOTO DIS5
    
ALARMA:
    MOVLW 00110000B	    ;ENCENDER LED DE ESTADO 4
    MOVWF PORTA
    ;BSF PORTA, 4
    BSF TRISB, 3	    ;ACTIVAR BOTONES PARA CONFIGURACION DE ALARMA
    BSF TRISB, 4
    BSF IOCB, 3
    BSF IOCB, 4
    BCF INTCON, 6	    ;DESACTIVAR INTERRUPCIONES DEL TIMER1
    BTFSC DIS, 0	    ;MULTIPLEXEO DISPLAYS
    GOTO DIS0
    BTFSC DIS, 1
    GOTO DIS1
    BTFSC DIS, 2
    GOTO DIS2
    BTFSC DIS, 3
    GOTO DIS3
    BTFSC DIS, 4
    GOTO DIS4
    BTFSC DIS, 5
    GOTO DIS5
    
CHECK:
    MOVF contlseg, W	    ;CHEQUEAR SI LOS SEGUNDOS DE ALARMA Y SEGUNDOS DE MODO HORA SON IGUALES
    SUBWF contlsega, W
    BTFSS STATUS, 2
    RETURN
    MOVF contldec, W	    ;CHEQUEAR SI LAS DECENAS DE SEGUNDOS DE ALARMA Y SEGUNDOS DE MODO HORA SON IGUALES
    SUBWF contldeca, W
    BTFSS STATUS, 2
    RETURN
    MOVF contlmin, W	    ;CHEQUEAR SI LAS UNIDADES DE MINUTOS DE ALARMA Y SEGUNDOS DE MODO HORA SON IGUALES
    SUBWF contlmina, W
    BTFSS STATUS, 2
    RETURN
    MOVF contldecmin, W	    ;CHEQUEAR SI LAS DECENAS DE MINUTOS DE ALARMA Y SEGUNDOS DE MODO HORA SON IGUALES
    SUBWF contldecmina, W
    BTFSS STATUS, 2
    RETURN
    MOVF contlhora, W	    ;CHEQUEAR SI LAS UNIDADES DE HORA DE ALARMA Y SEGUNDOS DE MODO HORA SON IGUALES
    SUBWF contlhoraa, W
    BTFSS STATUS, 2
    RETURN
    MOVF contldechora, W    ;CHEQUEAR SI LAS DECENAS DE HORA DE ALARMA Y SEGUNDOS DE MODO HORA SON IGUALES
    SUBWF contldechoraa, W
    BTFSS STATUS, 2
    RETURN
    BCF PORTA, 5	    ;ENCENDER LA ALARMA
    RETURN
    
    
    
DIS0:
    BSF TRISD, 0	    ;MULTIPLEXEO DE DISPLAYS
    BCF TRISD, 1
    BCF TRISD, 2
    BCF TRISD, 3
    BCF TRISD, 4
    BCF TRISD, 5
    
    BTFSC estado, 4	    ;EN ESTADO 4 MOSTRAR VALORES DEL MODO ALARMA
    GOTO $+8
    BTFSS estado, 3	    ;EN ESTADO TRES MOSTRAR VALORES DE MES Y DIA
    GOTO $+2
    GOTO $+3
    BTFSS estado, 2	    ;EN ESTADO 2 MOSTRAR VALORES DE MES Y DIA
    GOTO $+5
    MOVLW 2
    GOTO $+4
    MOVF contlsega, W
    GOTO $+2
    MOVF contlseg, W	    ;EN ESTADO 0 Y 1 MOSTRAR VALORES DE HORA
    PAGESEL tabla
    CALL tabla		    ;LLAMAR A LA TABLA 
    PAGESEL DIS0
    MOVWF PORTC		    ;CONVERSION DE LA TABLA A DISPLAY, PARA MOSTRAR EN EL PUERTO C
    BSF DIS, 1		    ;ENCENDER SIGUIENTE DISPLAY
    BCF DIS, 0
    GOTO VERIFICACION	    ;IR AL DELAY DEL MUESTREO DE LOS DISPLAYS
    
DIS1:
    BCF TRISD, 0	    ;MULTIPLEXEO DISPLAYS
    BSF TRISD, 1
    BCF TRISD, 2
    BCF TRISD, 3
    BCF TRISD, 4
    BCF TRISD, 5
    
    BTFSC estado, 4	    ;EN ESTADO 4 MOSTRAR VALORES DEL MODO ALARMA
    GOTO $+8
    BTFSS estado, 3	    ;EN ESTADO 3 MOSTRAR VALORES DEL MODO CONFIGURACION FECHA
    GOTO $+2
    GOTO $+3
    BTFSS estado, 2	    ;EN ESTADO 2 MOSTRAR VALORES DEL MODO VER FECHA
    GOTO $+5
    MOVLW 2
    GOTO $+4
    MOVF contldeca, W
    GOTO $+2
    MOVF contldec, W	    ;EN ESTADO 0 Y 1 MOSTRAR VALORES DEL MODO HORA Y CONFIGURACION HORA
    PAGESEL tabla
    CALL tabla		    ;LLAMAR A TABLA
    PAGESEL DIS1
    MOVWF PORTC		    ;MOSTRAR EN EL PUERTO C LA CONVERSION DE LA TABLA A DISPLAY0
    BSF DIS, 2		    ;ENCENDER SIGUIENTE DISPLAY
    BCF DIS, 1
    GOTO VERIFICACION	    ;IR A FUNCION PARA DELAY DE DISPLAYS
    
DIS2:
    BCF TRISD, 0	    ;MULTIPLEXEO DE DISPLAYS
    BCF TRISD, 1
    BSF TRISD, 2
    BCF TRISD, 3
    BCF TRISD, 4
    BCF TRISD, 5
    
    BTFSC estado, 4	    ;EN ESTADO 4 MOSTRAR VALORES DEL MODO ALARMA
    GOTO $+8
    BTFSS estado, 3	    ;EN ESTADO 3 MOSTRAR VALORES DEL MODO CONFIGURACION FECHA
    GOTO $+2
    GOTO $+3
    BTFSS estado, 2	    ;EN ESTADO 2 MOSTRAR VALORES DEL MODO FECHA
    GOTO $+5
    MOVF contmesu, W
    GOTO $+4
    MOVF contlmina, W
    GOTO $+2
    MOVF contlmin, W	    ;EN ESTADO 0 Y 1 MOSTRAR VALORES DEL MODO HORA Y CONFIGURACION HORA
    PAGESEL tabla
    CALL tabla		    ;LLAMAR A TABLA
    PAGESEL DIS2
    MOVWF PORTC		    ;MOSTRAR EN EL PUERTO C LA CONVERSION DE LA TABLA A DISPLAY
    BSF DIS, 3		    ;ENCENDER SIGUIENTE DISPLAY
    BCF DIS, 2
    GOTO VERIFICACION	    ;IR A DELAY DELAY DE DISPLAYS

DIS3:
    BCF TRISD, 0	    ;MULTIPLEXEO DE DISPLAYS
    BCF TRISD, 1
    BCF TRISD, 2
    BSF TRISD, 3
    BCF TRISD, 4
    BCF TRISD, 5
    
    BTFSC estado, 4	    ;EN ESTADO 4 MOSTRAR VALORES DEL MODO ALARMA
    GOTO $+8
    BTFSS estado, 3	    ;EN ESTADO 3 MOSTRAR VALORES DEL MODO CONFIGURACION FECHA
    GOTO $+2
    GOTO $+3
    BTFSS estado, 2	    ;EN ESTADO 2 MOSTRAR VALORES DEL FECHA
    GOTO $+5
    MOVF contmesd, W
    GOTO $+4
    MOVF contldecmina, W    
    GOTO $+2
    MOVF contldecmin, W	    ;EN ESTADO 0 Y 1 MOSTRAR VALORES DEL MODO HORA Y CONFIGURACION HORA
    PAGESEL tabla
    CALL tabla		    ;LLAMAR TABLA
    PAGESEL DIS3
    MOVWF PORTC		    ;MOSTRAR EN EL PUERTO C LA CONVERSION DE LA TABLA A DISPLAY
    BSF DIS, 4		    ;ENCENDER SIGUIENTE DISPLAY
    BCF DIS, 3	    
    GOTO VERIFICACION	    ;IR AL DELAY DE DISPLAYS
    
DIS4:
    BCF TRISD, 0	    ;MULTIPLEXEO DISPLAYS
    BCF TRISD, 1
    BCF TRISD, 2
    BCF TRISD, 3
    BSF TRISD, 4
    BCF TRISD, 5
    
    BTFSC estado, 4	    ;EN ESTADO 4 MOSTRAR VALORES DEL MODO ALARMA
    GOTO $+8
    BTFSS estado, 3	    ;EN ESTADO 3 MOSTRAR VALORES DEL MODO CONFIGURACION FECHA
    GOTO $+2
    GOTO $+3
    BTFSS estado, 2	    ;EN ESTADO 2 MOSTRAR VALORES DEL MODO FECHA
    GOTO $+5
    MOVF contdiau, W
    GOTO $+4
    MOVF contlhoraa, W
    GOTO $+2
    MOVF contlhora, W	    ;EN ESTADO 0 Y 1 MOSTRAR VALORES DEL MODO HORA Y CONFIGURACION HORA
    PAGESEL tabla
    CALL tabla		    ;LLAMAR A TABLA
    PAGESEL DIS4
    MOVWF PORTC		    ;MOSTRAR EN EL PUERTO C LA CONVERSION DE LA TABLA A DISPLAY
    BSF DIS, 5		    ;ENCENDER SIGUIENTE DISPLAY
    BCF DIS, 4
    GOTO VERIFICACION	    ;IR A DELAY DE DSIPLAYS
    
DIS5:	    
    BCF TRISD, 0	    ;MULTIPLEXEO DE DISPLAYS
    BCF TRISD, 1
    BCF TRISD, 2
    BCF TRISD, 3
    BCF TRISD, 4
    BSF TRISD, 5
    
    BTFSC estado, 4	   ;EN ESTADO 4 MOSTRAR VALORES DEL MODO ALARMA 
    GOTO $+8
    BTFSS estado, 3	   ;EN ESTADO 3 MOSTRAR VALORES DEL MODO CONFIGURACION DE FECHA
    GOTO $+2
    GOTO $+3
    BTFSS estado, 2	   ;EN ESTADO 2 MOSTRAR VALORES DEL MODO FECHA
    GOTO $+5
    MOVF contdiad, W
    GOTO $+4
    MOVF contldechoraa, W
    GOTO $+2
    MOVF contldechora, W    ;EN ESTADO 0 Y 1 MOSTRAR VALORES DEL MODO ALARMA
    PAGESEL tabla
    CALL tabla		    ;LLAMAR A TABLA
    PAGESEL DIS5
    MOVWF PORTC		    ;MOSTRAR EN EL PUERTO C LA CONVERSION DE LA TABLA A DISPLAY
    BSF DIS, 0		    ;ENCENDER SIGUIENTE DISPLAY
    BCF DIS, 5
    GOTO VERIFICACION	    ;IR A DELAY DE DISPLAYS
    
VERIFICACION:
    BTFSS INTCON, 2	    ;REVISAR BIT DE INTERRUPCION DEL TIMER0
    GOTO VERIFICACION	    ;REGRESAR A VERIFICACION 
    BCF INTCON, 2	    ;LIMPIAR BANDERA DE INTERRUPCION
    BANKSEL TMR0	    ;IR AL BANCO DEL TIMER 0
    MOVLW 253		    ;MOVER VALOR PARA DELAY a W
    MOVWF TMR0		    ;PONER EL VALOR PARA DELAY EN EL Timer0
    GOTO LOOP		    ;REGRESAR AL LOOP

;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    

VERI1D:
    BCF INTCON, 0	    ;LIMPIAR BANDERA DE INTERRUPCION DEL PUERTO B
    BTFSS estado, 1	    ;REVISAR SI ES ESTADO 1
    RETURN		    ;SI NO ES SALIR YA QUE UNICAMENTE SE PUEDE DECREMENTAR EN MODO CONFIGURACION
    BTFSS CDIS, 0	    ;REVISAR SI SE QUIEREN DECREMENTAR LOS SEGUNDOS
    GOTO VERI3D		    ;SINO IR A DECREMENTAR MINITOS
    BTFSS ban, 1	    ;REVISAR LA BANDERA
    RETURN		    ;REGRESAR
    CLRF ban		    ;LIMPIAR ANTIRREBOTE
    DECF contlseg, F	    ;INCREMENTAR CONTADOR DE UNIDADES DE SEGUNDO
    MOVF contlseg, W	    ;MOVER EL VALOR DEL CONTADOR A W
    SUBLW 255		    ;VER SI ES 0 Y HACER UNDERFLOW
    BTFSS STATUS, 2	    ;REVISAR SI HAY UNDERFLOW
    RETURN		    ;REGRESAR
    MOVLW 9		    ;PONER NUEVE EN LAS UNIDADES DE SEGUNDO
    MOVWF contlseg	    
    GOTO VERI2D		    ;IR A DECREMENTAR DECENAS DE SEGUNDO
    
VERI2D:
    BCF INTCON, 0	    ;LIMPIAR INTERRUPCION DEL PUERTO B
    DECF contldec, F	    ;DECREMENTAR CONTADOR DE DECENAS DE SEGUNDO
    MOVF contldec, W	    ;MOVER EL VALOR DEL CONTADOR A W 
    SUBLW 255		    ;REVISAR SI HAY UNDERFLOW
    BTFSS STATUS, 2
    RETURN
    MOVLW 5		    ;PONER 5 EN LAS DECENAS DE SEGUNDO
    MOVWF contldec	    
    RETURN		    ;REGRESAR

VERI3D:
    BCF INTCON, 0	    ;LIMPIAR INTERRUPCION DEL PUERTO B
    BTFSS estado, 1	    ;REVISAR SI ES ESTADO YA QUE SOLO S PUEDE DECREMENTAR EN MODO DE CONFIGURACION 
    RETURN		    ;REGRESAR
    BTFSS CDIS, 1	    ;REVISAR SI SE QUIERE MODIFICAR LOS MINUTOS
    GOTO VERI5D		    ;SINO IR A MODIFICAR HORAS
    BTFSS ban, 1	    ;REVISAR BANDERA DE ANTIRREBOTE
    RETURN		    ;REGRESAR
    CLRF ban		    ;LIMPIAR BANDERA
    DECF contlmin, F	    ;DECREMETNAR UNIDADES DE MINUTO
    MOVF contlmin, W        ;MOVER EL VALOR DEL CONTADOR A W 
    SUBLW 255		    ;RESTAR 6 DE W, YA QUE QUEREMOS QUE CUANDO LLEGUE A 60 SE REINICIE
    BTFSS STATUS, 2	    ;CHEQUEAR SI LA RESTA ES 0
    RETURN		    ;SI NO ES 0, RETORNAMOS
    MOVLW 9		    ;MOVER 9 A LAS UNIDADES DE MINUTO SI HAY UNDERFLOW
    MOVWF contlmin
    GOTO VERI4D		    ;IR A DECREMENTAR DECENAS DE SEGUNDO

VERI4D:
    DECF contldecmin, F	    ;DECREMENTAR DECENAS DE MINUTO
    MOVF contldecmin, W	    ;MOVER EL VALOR DEL CONTADOR A W 
    SUBLW 255		    ;RESTAR 6 DE W, YA QUE QUEREMOS QUE CUANDO LLEGUE A 60 SE REINICIE
    BTFSS STATUS, 2	    ;CHEQUEAR SI LA RESTA ES 0
    RETURN		    ;SI NO ES 0, RETORNAMOS
    MOVLW 5		    ;MOVER 5 A DECENAS DE MINUTO SI HAY UNDERFLOW
    MOVWF contldecmin		
    RETURN		    ;REGRESAR

VERI5D:
    BCF INTCON, 0	    ;LIMPIAR BANDERA DE INTERRUPCION DEL PUERTO B
    BTFSS estado, 1	    ;REVISAR SI ESTADO 1 YA QUE SOLO SE PUEDE DECREMENTAR EN MODO CONFIGURACION
    RETURN		    ;REGRESAR
    BTFSS CDIS, 2	    ;REVISAR SI E QUIERE MODIFICAR HORAS
    RETURN		    ;SINO REGRESAR A MODIFICAR SEGUNDOS
    BTFSS ban, 1	    ;REVISAR BANDERA DE ANTIRREBOTE
    RETURN		    ;REGRESAR
    CLRF ban		    ;LIMPIAR BANDERA DE ANTIRREBOTE
    DECF contlhora, F	    ;DECREMENTAR CONTADOR DE UNIDADES DE HORA
    MOVF contldechora, W    ;MOVER EL VALOR DEL CONTADOR A W 
    SUBLW 0		    ;REVISAR SI LAS DECENAS DE HORA SON 0
    BTFSS STATUS, 2	    ;CHEQUEAR SI LA RESTA ES 0
    GOTO $+4		    ;SI NO ES 0, RETORNAMOS
    MOVF contlhora, W	    ;REVISAR SI LAS UNIDADES DE HORA SON 0
    SUBLW 255		    
    BTFSS STATUS, 2
    GOTO $+6
    MOVLW 2		    ;SI AMBAS SON CERO Y SE DECREMENTA SE PONEN LAS 23 HORAS
    MOVWF contldechora
    MOVLW 3
    MOVWF contlhora
    RETURN		    ;REGRESAR
    MOVF contlhora, W	    ;MOVER EL VALOR DEL CONTADOR A W 
    SUBLW 255		    ;REVISAR SI HAY UNDERFLOW EN LAS UNIDADES DE HORA
    BTFSS STATUS, 2	    ;VER SI HAY UNDERFLOW
    RETURN		    ;SI NO ES 0, RETORNAMOS
    DECF contldechora	    ;DECREMENTAR LAS DECENAS DE HORA
    MOVLW 9		    ;MOVER 9 A LAS UNIDADES DE HORA
    MOVWF contlhora
    RETURN		    ;REGRESAR
    
VERI5:
    BCF INTCON, 0	    ;LIMPIAR BANDERA DE INTERRUPCION DEL PUERTO B
    BTFSS estado, 1	    ;REVISAR SI ESTADO 1 PARA INCREMENTAR
    GOTO $+7		    
    BTFSS CDIS, 2	    ;REVISAR SI SE QUIERE INCREMENTAR HORAS
    RETURN		    ;SI NO MODIFICAR LOS SEGUNDOS OTRA VEZ
    BTFSS ban, 0	    ;REVISAR BANDERA DE ANTIRREBOTE
    RETURN		    ;REGRESAR
    CLRF ban		    ;LIMPIAR BANDERA DE ANTIRREBOTE
    GOTO $+3	    
    BTFSS estado, 0	    ;REVISAS SI ES ESTADO 0
    RETURN		    ;REGRESAR
    INCF contlhora, F	    ;INCREMENTAR CONTADOR DE UNIDADES DE HORA
    MOVF contldechora, W    ;MOVER EL VALOR DEL CONTADOR A W 
    SUBLW 2		    ;REVISAR SI SON LAS 24 HORAS Y CHEQUEAR OVERFLOW
    BTFSS STATUS, 2	    ;CHEQUEAR SI LA RESTA ES 0
    GOTO $+4		    ;SI NO ES 0 SALTEAMOS OVERFLOW
    MOVF contlhora, W	    
    SUBLW 4
    BTFSS STATUS, 2
    GOTO $+8
    CLRF contldechora	    ;SI SON LAS 24 HORAS PONER 00 EN UNIDADES Y DECENAS DE HORA Y LIMPIAR TODAS LAS VARIABLES
    CLRF contlhora
    CLRF contldecmin
    CLRF contlmin
    CLRF contlseg	    
    CLRF contldec           
    GOTO VERI6
    MOVF contlhora, W	    ;MOVER EL VALOR DEL CONTADOR A W 
    SUBLW 10		    ;RESTAR 10 DE W, YA QUE QUEREMOS QUE CUANDO LLEGUE A 10 SE REINICIE
    BTFSS STATUS, 2	    ;CHEQUEAR SI HAY OVERFLOW EN UNIDADES DE HORA
    RETURN		    ;SI NO ES 0, RETORNAMOS
    INCF contldechora	    ;INCREMENTAR LAS DECENAS DE HORA SI HAY OVERFLOW
    CLRF contlhora	    ;LIMPIAR UNIDADES DE HORA
    BTFSC CDIS, 2	    ;REVISAR SI QUIEREN MODIFICAR LAS HORAS
    RETURN		    ;REGRESAR
    CLRF contldecmin	    ;LIMPIAR VARIABLES
    CLRF contlmin
    CLRF contlseg		  
    CLRF contldec              
    RETURN		    ;REGRESAR
    
VERI6:
    BCF INTCON, 0	    ;LIMPIAR BANDERA DE INTERRUPCION DEL PUERTO B
    BTFSS estado, 3	    ;REVISAR SI ES ESTADO 3
    GOTO $+6		    ;SI NO AUMENTAR POR MEDIO DEL TIMER
    BTFSS ban, 0	    ;REVISAR BANDERA DE ANTIRREBBOTE
    RETURN		    ;REGRESAR
    CLRF ban		    ;LIMPIAR ANTIRREBOTE
    BTFSC CDIS, 0	    ;REVISAR SI SE QUIERE AUMENTAR MESES
    GOTO CHEQUEOCAMBIOMES   ;IR A FUNCION AUMENTAR MES
    INCF contdiau, F	    ;SI NO AUMENTAR DIAS
    CALL CHEQUEO	    ;REVISAR SI ES MES DE 30, 31 DIAS O FEBRERO
    BTFSC feb, 0	    ;REVISAR SI ES FEBRERO
    GOTO $+47		    ;IR A CONFIGURACION DE FEBRERO
    BTFSS cantmes, 0	    ;IR A CONFIGURACION DE 31 DIAS
    GOTO $+23
    MOVF contdiad, W	    ;PONER LIMITES DE OVERFLOW PARA 31 DIAS
    SUBLW 3
    BTFSS STATUS, 2
    GOTO $+12
    MOVF contdiau, W
    SUBLW 2
    BTFSS STATUS, 2
    GOTO $+8
    INCF contmesu, F	    ;INCREMENTAR UNIDADES DE MES
    INCF contlmes, F	    ;INCREMENTAR CONTADOR DE MES PARA CHEQUEO
    CALL MES2		    ;IR A FUNCION DE CHEQUEO DE DICIEMBRE
    MOVLW 1		    ;PONER EN DIA 1 SI SE AUMENTO DE MES
    MOVWF contdiau
    CLRF contdiad	    ;LIMPIAR DECENAS DE DIA
    CLRF cantmes	    ;LIMPIAR VERIFICADOR DE MES
    MOVF contdiau, W
    SUBLW 10
    BTFSS STATUS, 2	    ;REVISAR SI HAY OVERFLOW EN UNIDADES DE DIAS
    RETURN
    CLRF contdiau
    INCF contdiad	    ;INCREMENAR DECENAS DE DIA
    RETURN		    ;REGRESAR
    MOVF contdiad, W;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    SUBLW 3		    ;PONER LIMITES PARA MES DE 30 DIAS
    BTFSS STATUS, 2
    GOTO $+12
    MOVF contdiau, W
    SUBLW 1
    BTFSS STATUS, 2
    GOTO $+8
    INCF contmesu, F	    ;INCREMENAR MES 
    INCF contlmes, F	    ;INCREMENTAR CONTADOR DE MES
    CALL RESETMES	    ;IR A FUNCION DE RESETMES PARA OVERFLOW DE 9 A 10
    MOVLW 1		    ;SI LOS MESES PASARON DE 09 PONER 10 COMO SIGUIENTE
    MOVWF contdiau
    CLRF contdiad
    CLRF cantmes
    MOVF contdiau, W	    ;REVISAR OVERFLOW EN LAS UNIDADES DE DIA
    SUBLW 10
    BTFSS STATUS, 2	    ;REVISAR SI HAY OVERFLOW EN UNIDADES DE DIAS
    RETURN
    CLRF contdiau
    INCF contdiad, F	    ;INCREMENAR DECENAS DE DIA
    RETURN		    ;REGRESAR
    MOVF contdiad, W ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    SUBLW 2		    ;PONER LIMITES PARA MES DE FFEBRERO
    BTFSS STATUS, 2	    
    GOTO $+12
    MOVF contdiau, W
    SUBLW 9
    BTFSS STATUS, 2
    GOTO $+8
    INCF contmesu, F	    ;INCREMENTAR MES
    INCF contlmes, F	    ;INCREMENTAR CONTADOR DE MES
    MOVLW 1		    
    MOVWF contdiau	    ;SI SE AUMENTO DE MES PONER 01 EN LOS DIAS
    CLRF contdiad
    CLRF cantmes	    ;LIMPIAR VERIFICADOR DE MES
    CLRF feb		    ;LIMPIAR VERIFICADOR DE FEBERERO
    MOVF contdiau, W	    ;CHEQUEAR SI HAY OVERFLOW EN UNIDADES DE DIAS
    SUBLW 10
    BTFSS STATUS, 2
    RETURN
    CLRF contdiau	    ;LIMPIAR UNIDADES DE DIAS
    INCF contdiad, F	    ;INCREMENTAR DECENAS DE DIAS
    RETURN		    ;REGRESAR
    
VERI1DF:
    BCF INTCON, 0	    ;LIMPIAR BANDERA DE INTERRUPCION DEL PUERTO B
    BTFSS estado, 3	    ;REVISAR SI ESTADO 3
    GOTO $+6		    
    BTFSS ban, 1	    ;REVISAR BANDERA DE ANTIRREBOTE
    RETURN		    ;REGRESAR
    CLRF ban		    ;LIMPIAR BANDERA
    BTFSC CDIS, 0	    ;REVISAR SI SE QUIERE MODIFICAR MESES
    GOTO CHEQUEOCAMBIOMES2  ;IR A FUNCION DE DECREMENTAR MESES
    DECF contdiau, F	    ;DECREMENTAR UNIDADES DE DIAS
    CALL CHEQUEO3	    ;REVISAR EN QUE MES SE ESTA 
    BTFSC feb, 0	    ;REVISAR SI ES FEBRERO
    GOTO $+51		    ;IR A CONFIGURACION DE FEBRERO
    BTFSS cantmes, 0	    ;REVISAR SI ES MES DE 31 DIAS
    GOTO $+25		    ;PONER LIMITES PARA MES DE 31 DIAS
    MOVF contdiad, W
    SUBLW 0
    BTFSS STATUS, 2
    GOTO $+13
    MOVF contdiau, W
    SUBLW 0
    BTFSS STATUS, 2
    GOTO $+9
    DECF contmesu, F	    ;DECREMENTAR UNIDADES DE MES
    DECF contlmes, F	    ;DECREMENTAR CONTADOR DE MES
    CALL MES3		    ;VERIFICAION DE UNDERFLOW DE MES
    MOVLW 1		    ;PONER 31 COMO UNDERFLOW
    MOVWF contdiau
    MOVLW 3
    MOVWF contdiad
    CLRF cantmes	    ;LIMPIAR VERIFICADOR DE MES
    MOVF contdiau, W	    ;REIVSAR SI HAY UNDERFLOW EN LAS UNIDADES DE DIA
    SUBLW 255
    BTFSS STATUS, 2
    RETURN
    MOVLW 9		    ;PONER 9 EN LAS UNIDADES DE DIA
    MOVWF contdiau
    DECF contdiad	    ;DECREMENTAR LAS DECENAS DE DIA
    RETURN		    ;REGRESAR
    MOVF contdiad, W;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    SUBLW 0		    ;PONER LIMITES PARA MES DE 30 DIAS
    BTFSS STATUS, 2
    GOTO $+13
    MOVF contdiau, W
    SUBLW 0
    BTFSS STATUS, 2
    GOTO $+9
    DECF contmesu, F	    ;DECREMENTAR UNIDADES DE MES
    DECF contlmes, F	    ;DECREMENTAR CONTADOR DE MES
    CALL RESETMES2	    ;IR A FUNCION DE UNDERFLOW DE MES 10=>9
    MOVLW 0		    ;MOVER 30 A DIAS SI HUBO UNDERFLOW 
    MOVWF contdiau
    MOVLW 3
    MOVWF contdiad
    CLRF cantmes	    ;LIMPIAR VERIFICADOR DE MES
    MOVF contdiau, W	    ;REIVSAR SI HAY UNDERFLOW EN LAS UNIDADES DE DIA
    SUBLW 255
    BTFSS STATUS, 2
    RETURN
    MOVLW 9		    ;PONER 9 EN LAS UNIDADES DE DIA SI HUBO UNDERFLOW
    MOVWF contdiau
    DECF contdiad, F	    ;DECREMENTAR DECENAS DE DIAS
    RETURN		    ;REGRESAR
    MOVF contdiad, W ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    SUBLW 0		    ;PONER LIMITES PARA FEBRERO
    BTFSS STATUS, 2
    GOTO $+13
    MOVF contdiau, W
    SUBLW 0
    BTFSS STATUS, 2
    GOTO $+9
    DECF contmesu, F	    ;DECREMENTAR UNIDADES DE MES
    DECF contlmes, F	    ;DECREMENTAR CONTADOR DE MES
    MOVLW 8		    ;MOVER 28 A DIAS SI HUBO UNDERFLOW
    MOVWF contdiau
    MOVLW 2
    MOVWF contdiad
    CLRF cantmes	    ;LIMPIAR VERIFICADOR DE MES
    CLRF feb		    ;LIMPIAR VERIFICADOR DE FEBRERO
    MOVF contdiau, W	    ;REIVSAR SI HAY UNDERFLOW EN LAS UNIDADES DE DIA
    SUBLW 255
    BTFSS STATUS, 2
    RETURN
    MOVLW 9		    ;PONER 9 EN LAS UNIDADES DE DIA SI HUBO UNDERFLOW
    MOVWF contdiau
    DECF contdiad, F	    ;;DECREMENTAR DECENAS DE DIAS
    RETURN		    ;REGRESAR
    
CHEQUEOCAMBIOMES:
    MOVLW 1		    ;SI SE CAMBIA EL MES PONER 01 EN DIAS PARA ASEGURAR QUE NO HAYAN PROBLEMAS DE DIAS 
    MOVWF contdiau
    CLRF contdiad	    ;LIMPIAR DECENAS DE DIAS
    INCF contlmes	    ;INCREMENTAR CONTADOR DE MES
    INCF contmesu	    ;INCREMENTAR UNIDADES DE MES
    CALL MES2		    ;IR A FUNCION PARA LIMITES DE OVERFLOW DE MES 12=>01
    CALL RESETMES	    ;LLAMAR A FUNCION DE OVERFLOW DE MES 09=>10
    RETURN		    ;REGRESAR
    
CHEQUEOCAMBIOMES2:
    MOVLW 1		    ;SI SE CAMBIA EL MES PONER 01 EN DIAS PARA ASEGURAR QUE NO HAYAN PROBLEMAS DE DIAS
    MOVWF contdiau
    CLRF contdiad	    ;LIMPIAR DECENAS DE DIAS
    DECF contlmes	    ;DECREMENTAR UNIDADES DE MES
    DECF contmesu	    ;DECREMENTAR CONTADOR DE MES
    CALL MES3		    ;IR A FUNCION PARA LIMITES DE UNDERFLOW DE MES 01=>12
    CALL RESETMES2	    ;LLAMAR A FUNCION DE OVERFLOW DE MES 10=>09 
    RETURN    
    
ANTI1:
    BSF ban, 0		    ;ENCENDER BANDERA
    RETURN
    
ANTI2:
    BSF ban, 1		    ;ENCENDER BANDERA
    RETURN
    
ANTI3:
    BSF ban, 2		    ;ENCENDER BANDERA
    RETURN
    
ANTI4:
    BSF ban, 3		    ;ENCENDER BANDERA
    RETURN
    
CHEQUEO:
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES ENERO
    SUBLW 1
    BTFSC STATUS, 2
    BSF cantmes, 0	    ;ENCENDER VERIFICADOR SI ES MES DE 31 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES MARZO
    SUBLW 3
    BTFSC STATUS, 2
    BSF cantmes, 0	    ;ENCENDER VERIFICADOR SI ES MES DE 31 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES ABRIL
    SUBLW 4
    BTFSC STATUS, 2
    BCF cantmes, 0	    ;APAGAR VERIFICADOR SI ES MES DE 30 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES MAYO
    SUBLW 5
    BTFSC STATUS, 2
    BSF cantmes, 0	    ;ENCENDER VERIFICADOR SI ES MES DE 31 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES JUNIO
    SUBLW 6
    BTFSC STATUS, 2
    BCF cantmes, 0	    ;APAGAR VERIFICADOR SI ES MES DE 30 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES JULIO
    SUBLW 7
    BTFSC STATUS, 2
    BSF cantmes, 0	    ;ENCENDER VERIFICADOR SI ES MES DE 31 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES AGOSTO
    SUBLW 8
    BTFSC STATUS, 2
    BSF cantmes, 0	    ;ENCENDER VERIFICADOR SI ES MES DE 31 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES SEPTIEMBRE
    SUBLW 9
    BTFSC STATUS, 2
    BCF cantmes, 0	    ;APAGAR VERIFICADOR SI ES MES DE 30 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES OCTUBRE
    SUBLW 10
    BTFSC STATUS, 2
    BSF cantmes, 0	    ;ENCENDER VERIFICADOR SI ES MES DE 31 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES NOVIEMBRE
    SUBLW 11
    BTFSC STATUS, 2
    BCF cantmes, 0	    ;APAGAR VERIFICADOR SI ES MES DE 30 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES DICIEMBRE
    SUBLW 12
    BTFSC STATUS, 2
    BSF cantmes, 0	    ;ENCENDER VERIFICADOR SI ES MES DE 31 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES FEBRERO
    SUBLW 2
    BTFSC STATUS, 2
    CALL CHEQUEO2	    ;IR A FUNCION DE FEBRERO
    RETURN
    
CHEQUEO2:
    CLRF cantmes	    ;LIMPIAR VERIFICADOR DE MES 
    BSF feb, 0		    ;ENCENDER VERIFICADOR DE FBEREO
    RETURN
    
CHEQUEO3:
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES DICIEMBRE
    SUBLW 1
    BTFSC STATUS, 2
    BSF cantmes, 0	    ;ENCENDER VERIFICADOR SI ES MES DE 31 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES ENERO
    SUBLW 2
    BTFSC STATUS, 2
    BSF cantmes, 0	    ;ENCENDER VERIFICADOR SI ES MES DE 31 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES MARZO
    SUBLW 4
    BTFSC STATUS, 2
    BSF cantmes, 0	    ;ENCENDER VERIFICADOR SI ES MES DE 31 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES ABRIL
    SUBLW 5
    BTFSC STATUS, 2
    BCF cantmes, 0	    ;APAGAR VERIFICADOR SI ES MES DE 30 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES MAYO
    SUBLW 6
    BTFSC STATUS, 2
    BSF cantmes, 0	    ;ENCENDER VERIFICADOR SI ES MES DE 31 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES JUNIO
    SUBLW 7
    BTFSC STATUS, 2
    BCF cantmes, 0	    ;APAGAR VERIFICADOR SI ES MES DE 30 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES JULIO
    SUBLW 8
    BTFSC STATUS, 2
    BSF cantmes, 0	    ;ENCENDER VERIFICADOR SI ES MES DE 31 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES AGOSTO
    SUBLW 9
    BTFSC STATUS, 2
    BSF cantmes, 0	    ;ENCENDER VERIFICADOR SI ES MES DE 31 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES SEPTIEMBRE
    SUBLW 10
    BTFSC STATUS, 2
    BCF cantmes, 0	    ;APAGAR VERIFICADOR SI ES MES DE 30 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES OCTUBRE
    SUBLW 11
    BTFSC STATUS, 2
    BSF cantmes, 0	    ;ENCENDER VERIFICADOR SI ES MES DE 31 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES NOVIEMBRE
    SUBLW 12
    BTFSC STATUS, 2
    BCF cantmes, 0	    ;APAGAR VERIFICADOR SI ES MES DE 30 DIAS
    MOVF contlmes, W	    ;REVISAR SI EL CONTADOR DE MES ES FEBRERO
    SUBLW 3
    BTFSC STATUS, 2
    CALL CHEQUEO4	    ;IR A FUNCION DE FEBRERO
    RETURN
    
CHEQUEO4:
    CLRF cantmes	    ;LIMPIAR VERIFICADOR DE MES
    BSF feb, 0		    ;ENCENDER FEBRERO
    RETURN
    
RESETMES:
    MOVF contmesu, W	    ;REVISAR SI HAY OVERFLOW DE MES 9=>10
    SUBLW 10
    BTFSS STATUS, 2
    RETURN
    CLRF contmesu	    ;LIMPIAR UNIDADES DE MES
    INCF contmesd, F	    ;INCREMENTAR DECENAS DE MES
    RETURN		    ;REGRESAR
    
RESETMES2:
    MOVF contmesu, W	    ;REVISAR SI HAY UNDERFLOW DE MES 10=>09
    SUBLW 255
    BTFSS STATUS, 2
    RETURN
    MOVLW 9
    MOVWF contmesu	    ;MOVER 9 A UNIDADES DE MES
    DECF contmesd, F	    ;DECREMENTAR DECENAS DE MES
    RETURN		    ;REGRESAR
    
MES2:
    MOVF contmesd, W	    ;REVISAR OVERFLOW DE MES 12=>01
    SUBLW 1
    BTFSS STATUS, 2
    RETURN
    MOVF contmesu, W
    SUBLW 3
    BTFSS STATUS, 2
    RETURN
    CLRF contmesd	    ;SI HAY OVERFLOE MOVER 1 A UNIDADES DE MES
    MOVLW 1		    ;LIMPIAR DECENAS DE MES
    MOVWF contmesu	
    MOVWF contlmes	    ;PONER EN UNO EL CONTADOR DE MES
    RETURN		    ;REGRESAR
    
MES3:
    MOVF contmesd, W	    ;REVISAR OVERFLOW DE MES 01=>12
    SUBLW 0
    BTFSS STATUS, 2
    RETURN
    MOVF contmesu, W
    SUBLW 0
    BTFSS STATUS, 2
    RETURN
    MOVLW 1		    ;SI HAY OVERFLOE MOVER 1 A DECENAS DE MES
    MOVWF contmesd
    MOVLW 2		    ;PONER EN DOS LAS UNIDADES DE MES
    MOVWF contmesu
    MOVLW 12		    ;PONER EN 12 EL CONTADOR DE MES
    MOVWF contlmes  
    RETURN		    ;REGRESAR
    
VERI1A:
    BCF INTCON, 0	    ;LIMPIAR BANDERA DEL PUERTO B
    BTFSS estado, 4	    ;REVISAR SI ES ESTADO 4
    GOTO $+7
    BTFSS CDIS, 0	    ;REVISAR SI SE QUIEREN MODIFICAR LOS SEGUNDOS
    GOTO VERI3A		    ;IR A MODIFICAR MINUTOS
    BTFSS ban, 0	    ;REVISAR BANDERA DE ANTIRREBOTE
    RETURN		    ;REGRESAR
    CLRF ban		    ;LIMPIAR BANDERA
    GOTO $+3
    BTFSS estado, 0	    
    RETURN
    INCF contlsega, F	    ;INCREMENTAR CONTADOR DE UNIDADES DE SEGUNDO
    BCF INTCON, 0
    MOVF contlsega, W	    ;MOVER EL VALOR DEL CONTADOR A W
    SUBLW 10		    ;RESTAR 10 DE W
    BTFSS STATUS, 2	    ;REVISAR SI LA RESTA ES 0
    RETURN		    ;SI LA RESTA NO ES 0, RETORNAR
    CLRF contlsega	    ;SI ES 0, REINCIAR EL CONTADOR
    GOTO VERI2A		    ;IR A AUMENTAR DECENAS DE SEGUNDO
    
VERI2A:
    BCF INTCON, 0
    INCF contldeca, F	    ;INCREMENTAR CONTADOR DE DECENAS DE SEGUNDO
    MOVF contldeca, W	    ;MOVER EL VALOR DEL CONTADOR A W 
    SUBLW 6		    ;RESTAR 6 DE W, YA QUE QUEREMOS QUE CUANDO LLEGUE A 60 SE REINICIE
    BTFSS STATUS, 2	    ;CHEQUEAR SI LA RESTA ES 0
    RETURN		    ;SI NO ES 0, RETORNAMOS
    CLRF contlsega	    ;LIMPIAR VARIABLES
    CLRF contldeca            
    BTFSC estado, 4
    RETURN
    GOTO VERI3A		    ;IR A AUMENTAR UNIDADES DE MINUTOS

VERI3A:
    BCF INTCON, 0	    ;LIMPIAR INTERRUPCION DEL PUERTO B
    BTFSS estado, 4	    ;REVISAR SI ES ESTADO 4
    GOTO $+7		    
    BTFSS CDIS, 1	    ;REVISAR SI SE QUIERE MODIFICAR LOS MINUTOS
    GOTO VERI5A		    ;IR A MODIFICAR HORAS
    BTFSS ban, 0	    ;REVISAR BANDERA DE ANTIRREBOTE
    RETURN		    ;REGRESAR
    CLRF ban		    ;LIMPIAR BANDERA
    GOTO $+3
    BTFSS estado, 0
    RETURN
    INCF contlmina, F       ;INCREMENTAR UNIDADES DE MINUTOS
    MOVF contlmina, W       ;REVISAR SI HAY OVERFLOW 
    SUBLW 10		    ;RESTAR 10 DE W, YA QUE QUEREMOS QUE CUANDO LLEGUE A 10SE REINICIE
    BTFSS STATUS, 2	    ;CHEQUEAR SI LA RESTA ES 0
    RETURN		    ;SI NO ES 0, RETORNAMOS
    CLRF contlmina	    ;LIMPIAR VARIABLES
    CLRF contldeca              
    CLRF contlsega
    GOTO VERI4A		    ;IR A AUMENTAR DECENAS DE MINUTOS

VERI4A:
    INCF contldecmina, F    ;INCREMENTAR DECENAS DE MINUTOS
    MOVF contldecmina, W    ;REVISAR OVERFLOW 
    SUBLW 6		    ;RESTAR 6 DE W, YA QUE QUEREMOS QUE CUANDO LLEGUE A 60 SE REINICIE
    BTFSS STATUS, 2	    ;CHEQUEAR SI LA RESTA ES 0
    RETURN		    ;SI NO ES 0, RETORNAMOS
    CLRF contldecmina	    ;LIMPIAR VARIABLES
    CLRF contlmina
    CLRF contlsega		    
    CLRF contldeca             
    BTFSC estado, 4	    ;REVISAR SI ES ESTADO 4
    RETURN		    ;REGRESAR
    GOTO VERI5A		    ;IR A INCREMENTAR HORAS
    
VERI5A:
    BCF INTCON, 0	    ;LIMPIAR INTERRUPCION DEL PUERTO B
    BTFSS estado, 4	    ;REVISAR SI ES ESTADO 4
    GOTO $+7		    ;SI NO REGRESAR
    BTFSS CDIS, 2	    ;REVISAR SI SE QUIERE MODIFICAR HORAS
    RETURN		    ;REGRESAR
    BTFSS ban, 0	    ;REVISAR BANDERA DE ANTIRREBOTE
    RETURN		    ;REGRESAR
    CLRF ban		    ;LIMPIAR BANDERA
    GOTO $+3
    BTFSS estado, 0	    
    RETURN
    INCF contlhoraa, F	    ;INCREMENTAR UNIDADES DE HORA
    MOVF contldechoraa, W   ;REVISAR SI HAY OVERFLOW DE HORAS
    SUBLW 2		    ;VER SI HA Y OVERFLOW
    BTFSS STATUS, 2	    ;CHEQUEAR SI LA RESTA ES 0
    GOTO $+4		    ;SI NO ES 0
    MOVF contlhoraa, W		
    SUBLW 4		    
    BTFSS STATUS, 2
    GOTO $+8
    CLRF contldechoraa	    ;SI HAY OVERFLOW DE 24 HORAS LIMPIAR TODAS LAS VARIABLES
    CLRF contlhoraa
    CLRF contldecmina
    CLRF contlmina
    CLRF contlsega		    
    CLRF contldeca              
    RETURN
    MOVF contlhoraa, W	    ;MOVER EL VALOR DEL CONTADOR A W 
    SUBLW 10		    ;RESTAR 10 DE W, YA QUE QUEREMOS QUE CUANDO LLEGUE A 10 SE REINICIE
    BTFSS STATUS, 2	    ;CHEQUEAR SI LA RESTA ES 0
    RETURN		    ;SI NO ES 0, RETORNAMOS
    INCF contldechoraa	    ;INCREMENTAR DECENAS DE HORA
    CLRF contlhoraa	    ;LIMPIAR UNIDADES DE HORA
    BTFSC CDIS, 2	    ;VER SI SE MODIFICAN HORAS
    RETURN
    CLRF contldecmina	    ;LIMPIAR VARIABLES
    CLRF contlmina
    CLRF contlsega		    
    CLRF contldeca              
    RETURN		    ;REGRESAR
    
VERI1DA:
    BCF INTCON, 0	    ;LIMPIAR BANDERA DEL PUERTO B
    BTFSS estado, 4	    ;REVISAR SI ESTADO 4
    RETURN		    ;REGRESAR
    BTFSS CDIS, 0	    ;REVISAR SI SE QUIERE MODIFICAR SEGUNODS
    GOTO VERI3DA	    ;SINO MODIFICAR MINUTOS
    BTFSS ban, 1	    ;REVISAR BANDERA DE ANTIRREBOTE
    RETURN		    ;REGRESAR
    CLRF ban		    ;LIMPIAR BANDERA
    DECF contlsega, F	    ;DECREMENTAR CONTADOR DE UNIDADES DE SEGUNDO
    MOVF contlsega, W	    ;MOVER EL VALOR DEL CONTADOR A W
    SUBLW 255		    ;CHEQUEAR SI HAY UNDERFLOW
    BTFSS STATUS, 2
    RETURN
    MOVLW 9		    ;SI HAY UNDERFLOW MOVER 9 A UNIDADES DE SEGUNDO
    MOVWF contlsega
    GOTO VERI2DA	    ;IR A DECREMENTAR DECENAS DE SEGUNDO
    
VERI2DA:
    BCF INTCON, 0	    ;LIMPIAR BANDERA DE PUERTO B
    DECF contldeca, F	    ;DECREMENTAR CONTADOR DE DECENAS DE SEGUNDO
    MOVF contldeca, W	    ;MOVER EL VALOR DEL CONTADOR A W 
    SUBLW 255		    ;CHEQUAR SI HAY UNDERFLOW
    BTFSS STATUS, 2
    RETURN		    ;SI HAY UNDERFLOW MOVER 5 A DECENAS DE SEGUNDOS
    MOVLW 5
    MOVWF contldeca
    RETURN		    ;REGRESAR

VERI3DA:
    BCF INTCON, 0	    ;LIMPIAR BANDERA DE INTERRUPCION DEL PUERTO B
    BTFSS estado, 4	    ;REVISAR SI ES ESTADO 4
    RETURN		    ;REGRESAR
    BTFSS CDIS, 1	    ;REVISAR SI SE QUIEREN MODIFICAR LOS MINUTOS
    GOTO VERI5DA	    ;IR A MODIFICAR HORAS
    BTFSS ban, 1	    ;REVISAR BANDERA DE ANTIRREBOTE
    RETURN		    ;REGRESAR
    CLRF ban		    ;LIMPIAR BANDERA
    DECF contlmina, F       ;DECREMENTAR UNIDADES DE MINUTO
    MOVF contlmina, W       ;MOVER EL VALOR DEL CONTADOR A W 
    SUBLW 255		    ;CHEQUEAR SI HAY UNDERFLOW
    BTFSS STATUS, 2	    ;CHEQUEAR SI LA RESTA ES 0
    RETURN		    ;SI NO ES 0, RETORNAMOS
    MOVLW 9		    ;SI HAY UNDERFLOW MOVER 9 A LAS UNIDADES DE MINUTO
    MOVWF contlmina
    GOTO VERI4DA	    ;IR A DECREMENTAR DECENAS DE MINUTO

VERI4DA:
    DECF contldecmina, F    ;DECREMENTAR DECENAS DE MINUTO
    MOVF contldecmina, W    ;MOVER EL VALOR DEL CONTADOR A W 
    SUBLW 255		    ;RESTAR 255 DE W, YA QUE QUEREMOS QUE CUANDO LLEGUE A 255 SE REINICIE
    BTFSS STATUS, 2	    ;CHEQUEAR SI LA RESTA ES 0
    RETURN		    ;SI NO ES 0
    MOVLW 5		    ;PONER 5 EN LAS DECENAS DE MINUTOS
    MOVWF contldecmina
    RETURN		    ;REGRESAR

VERI5DA:
    BCF INTCON, 0	    ;LIMIPIAR INTERRUPCION DEL PUERTO B
    BTFSS estado, 4	    ;VER SI ESTADO 4
    RETURN		    ;REGRESAR
    BTFSS CDIS, 2	    ;REVISAR SI SE QUIEREN MODIFICAR HORAS
    RETURN		    ;SINO MODIFICAR SEGUNDOS
    BTFSS ban, 1	    ;REVISAR BANDERA DE ANTIRREBOTE
    RETURN		    ;REGRESAR
    CLRF ban		    ;LIMPIAR BANDERA
    DECF contlhoraa, F	    ;DECREMENTAR UNIDADES DE HORA DE ALARMA
    MOVF contldechoraa, W   ;MOVER DECENAS DE HORA A	
    SUBLW 0		    ;RESTAR 0 DE W, YA QUE QUEREMOS QUE CUANDO LLEGUE A 0 SE PONGAN 23 HORAS
    BTFSS STATUS, 2	    ;CHEQUEAR SI LA RESTA ES 0
    GOTO $+4		    ;SI NO SALTAR VERIFICAION DE UNDERFLOW
    MOVF contlhoraa, W	    
    SUBLW 255
    BTFSS STATUS, 2
    GOTO $+6
    MOVLW 2		    ;SI HAY UNDERFLOW PONER LAS 23 HORAS
    MOVWF contldechoraa
    MOVLW 3
    MOVWF contlhoraa
    RETURN
    MOVF contlhoraa, W	    ;MOVER EL VALOR DEL CONTADOR A W 
    SUBLW 255		    ;RESTAR 255 DE W
    BTFSS STATUS, 2	    ;CHEQUEAR SI LA RESTA ES 0
    RETURN		    ;SI NO ES 0, RETORNAMOS
    DECF contldechoraa	    ;DECREMENTAR LAS DECENAS DE HORA
    MOVLW 9		    ;PONER 9 EN LAS UNIDADES DE SEGUNDO
    MOVWF contlhoraa
    RETURN		    ;REGRESAR
    
LEDS:
    BTFSS PIR1, 1	    ;REVISAR BANDERA DE INTERRUPCION DEL TIMER2
    RETURN		    ;REGRESAR
    BCF PIR1, 1		    ;LIMPIAR BANDERA DEL TIMER2
    INCF contled, F	    ;INCREMENTAR CONTADOR DE DELAY DE LEDS
    MOVF contled, W
    SUBLW 49		    ;REALIZAR RESTAS PARA DELAY
    BTFSS STATUS, 2
    RETURN
    CLRF contled	    ;AL LLEGAR AL DELAY DESEADO LIMPIAR CONTADOR
    BCF PORTE, 0	    ;APAGAR LEDS
    BANKSEL TMR2	    ;CARGAR VALOR AL TIMER2     
    MOVLW 200		    
    MOVWF TMR2		    
    RETURN		    ;REGRESAR
    
LEDS2:
    BTFSS PIR1, 1	    ;REVISAR BANDERA DE INTERRUPCION DEL TIMER2
    RETURN		    ;REGRESAR
    BCF PIR1, 1		    ;LIMPIAR BANDERA DEL TIMER2
    INCF contled, F	    ;INCREMENTAR CONTADOR DE DELAY DE LEDS
    MOVF contled, W	    
    SUBLW 49		    ;REALIZAR RESTAS PARA DELAY
    BTFSS STATUS, 2	
    RETURN
    CLRF contled	    ;AL LLEGAR AL DELAY DESEADO LIMPIAR CONTADOR
    BSF PORTE, 0	    ;ENCENDER LEDS
    BANKSEL TMR2	    ;CARGAR VALOR AL TIMER2
    MOVLW 200		    
    MOVWF TMR2		    
    RETURN		    ;REGRESAR
    
END